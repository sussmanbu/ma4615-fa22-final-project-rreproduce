---
title: Data
description:
toc: true
featuredVideo:
featuredImage: images/data-import-cheatsheet-thumbs.png
draft: false
---


<div id="TOC">

</div>

<p>Data Link</p>
<p>We care about the social justice in the United States. We hope to find out how migration would impact the change of the crime rate in the United States between (year1) and (year 2). Additionally, we are interested in find out whether other variables would moderate the association between migration pattern and crime rate, such as income levels and race.
Our migration data is from the [XXX]. We assorted the data in to several different data set, including [XXX]. Specifically, we used [sub-dataset 1], which describes [XXX], and [sub-dataset 2], which describes [XXX] to construct our models. Our crime rate data is from the [XXX]. We assorted our data into the number of “rubbery” and “bulglary” cases during [Year] by the states in the US.
Here are the links of the two data sets that we used: [Link].</p>
<p>Variables</p>
<p>The migration dataset contains # variables. We used # variables listed below:
1. resident number before migration by state (numeric)
2. resident number after migration by state (numeric)
3. original family income (categorical; from Q1 to Q5)
4. Race (categorical; [describe the race])
5. ……</p>
<p>The crime rate dataset contains 3 variables.
1. State (nominal; 50 in total)
2. Mean number of rubbery cases by states (numeric) in (year)
3. Mean number of bulglary cases by states in (year)</p>
<p>Specific Created Variables</p>
<p>##Data Import and Cleaning</p>
<p>After importing our primary dataset od.csv, we first separate the “pool” column into “race” and “income”</p>
<pre class="r"><code>## pool     -&gt;    race    |   income
## WhiteQ1  -&gt;   White    |     Q1</code></pre>
<p>Next we filter out 0 values from ‘n’ column (indicating that the path has no immigrants) and -1 and NA values from all cells (invalid number)</p>
<pre class="r"><code>##   filter(n != 0 &amp; n != -1) 
##   filter(n_tot_o != -1) 
##   filter(n_tot_d != -1)
##   od_data[is.na(od_data)] = 0</code></pre>
<p>To explore the data structure and out interests in the dataset, we have also created a sub dataset that contains people moved from MA to other states/stayed in MA. (see o_MA)</p>
<p>Our secondary data is separated in multiple files range from different years and each row represents different information by state.
Therefore, we only extracted the row indicating the total cases of crime categories of all states.
Crime categories do not have data for every year except for “Robbery” and “Burglary”. For the consistency of the analysis, we only use case numbers of “Robbery” and “Burglary” for analysis.</p>
<pre class="r"><code>## For instance: 2010 Crime Data import:
## data2010&lt;- data2010 %&gt;% fill(State) %&gt;% fill(Area) %&gt;% filter(Area == &#39;State Total&#39;) %&gt;% 
## filter(...3== &#39;Rate per 100,000 inhabitants&#39;) %&gt;% select(-Population,-...3)
## data2010 &lt;- data2010[, colSums(is.na(data2010)) &lt; nrow(data2010)]

## Crime data from 2000-2003 use different formats:
## data2003 &lt;- read_csv(here::here(&quot;dataset&quot;, &quot;2003.csv&quot;),skip = 4)%&gt;% 
##   filter(Area!= &#39;Metropolitan Statistical Area&#39;&amp;
##           Area!=&#39;Area actually reporting&#39;&amp;
##           Area!=&#39;Estimated totals&#39;&amp;
##           Area!=&#39;Cities outside metropolitan areas&#39;&amp;
##           Area!=&#39;Rural&#39;&amp;
##           Area!=&#39;State Total&#39;&amp;
##           Area!=&#39;Total&#39;&amp;
##           Area!=&#39;Nonmetropolitan counties&#39;&amp;
##           Area!=&#39;Estimated total&#39;) %&gt;% 
##   select(c(Area,Robbery,Burglary))
## data2003$Area &lt;- gsub(&#39;Rate per 100,000 inhabitants&#39;, NA, data2003$Area) 
## data2003 &lt;- data2003 %&gt;% 
##   fill(Area) %&gt;%
##   drop_na(Robbery, Burglary)</code></pre>
<p>Then we merged crime data from 2000-2007 and 2010-2017 into two datasets, each dataset is composed of state name and average crime cases. This is because this data is collected when these people were at age 16 and 26 and they were born between between 1984-1992. So we have calculated the time period of these people at age 16 and 26 to seperate the datasets. Note that crime data for year 2004 is missing on the website so we skiped that year during the analysis(since we are using the average it should not be an issue).</p>
<pre class="r"><code>## Combine 2000-2007 crime data
## df_list &lt;- list(data2000, data2001, data2002,data2003,data2005,data2006,data2007)
## mergedf &lt;- Reduce(function(x, y) merge(x, y, all=TRUE), df_list)
## mergedf$Area &lt;- gsub(&#39;[0-9., ]&#39;, &#39;&#39;, mergedf$Area)
## mergedf &lt;- mergedf %&gt;%
##   group_by(Area) %&gt;%
##   summarize(meanRobbery = mean(as.numeric(Robbery)),meanBurglary = mean(Burglary))</code></pre>
<p>And the merged dataset is now ready for analysis.</p>
<p>link to <a href="here::here(%22load_and_clean_data.R%22)">load_and_clean_data.R</a></p>
<div id="files-in-static" class="section level2">
<h2>Files in static</h2>
<div id="load_and_clean_data.r" class="section level3">
<h3><code>load_and_clean_data.R</code></h3>
<p>The idea behind this file is that someone coming to your website could largely replicate your analyses after running this script on the original data sets to clean them.
This file might create a derivative data set that you then use for your subsequent analysis.
Note that you don’t need to run this script from every post/page.
Instead, you can load in the results of this script, which could be plain text files or <code>.RData</code> files. In your data page you’ll describe how these results were created. If you have a very large data set, you might save smaller data sets that you can use for exploration purposes.
To link to this file, you can use <code>[cleaning script](/load_and_clean_data.R)</code>.</p>
<p>When you are loading in data, I recommend using the <code>here::here</code> function to specify the file path. This function is used to specify a path relative to your project’s root directory. Hence, you can read a file using eg, <code>read_csv(here::here("dataset/data_file.csv"))</code>.</p>
</div>
<div id="shiny-interactive" class="section level3">
<h3>Shiny Interactive</h3>
<p>We have not developed the Shiny interactive yet but we have our ideas listed below:</p>
<ol style="list-style-type: decimal">
<li>Firstly we want to use one plot graph to show the relationship between crime rate and income level in each state. Specifically, we will use the majority income level to represent each state (for example, if the population of income level in Q1 is the biggest in the state, then A will be shown as Q1 income level). Most people will assume that the less the income level, the more crime rate. However, there is no significant relationship between those two variables</li>
<li>Then, we will use the crosstalk function to make users see the crime rate and migration rate in each state. Users can playing with the selection button on the map to filter different regions among five regions: Northeast, Midwest, South, and West; as well as coastal and noncoastal. Users can also choose the migration rate range in the Magnitude to find corresponding states</li>
<li>Finally, if users are interested in predicting their future living location, they can input their personal information on 16-years-old: state, income level, and race, and the website will return the prediction result.
Or if users are elder than 26, they can also use this to check whether they follow the trend of migration. If wrong, we will ask users whether to provide their informations to help us improve our model.</li>
</ol>
<hr />
</div>
</div>
<div id="rubric-on-this-page-kept-for-reference" class="section level2">
<h2>Rubric: On this page (kept for reference)</h2>
<p>you will</p>
<ul>
<li>Describe where/how to find data.
<ul>
<li>You must include a link to the original data source(s). Make sure to provide attribution to those who collected the data.</li>
<li>Why was the data collected/curated? Who put it together? (This is important, if you don’t know why it was collected then that might not be a good dataset to look at.</li>
</ul></li>
<li>Describe the different data files used and what each variable means.
<ul>
<li>If you have many variables then only describe the most relevant ones and summarize the rest.</li>
</ul></li>
<li>Describe any cleaning you had to do for your data.
<ul>
<li>You <em>must</em> include a link to your <code>load_and_clean_data.R</code> file.</li>
<li>Also, describe any additional R packages you used outside of those covered in class.</li>
<li>Describe and show code for how you combined multiple data files and any cleaning that was necessary for that.</li>
<li>Some repetition of what you do in your <code>load_and_clean_data.R</code> file is fine and encouraged if it helps explain what you did.</li>
</ul></li>
<li>Organization, clarity, cleanliness of the page
<ul>
<li>Make sure to remove excessive warnings, use clean easy-to-read code (without side scrolling), organize with sections, use bullets and other organization tools, etc.</li>
</ul></li>
</ul>
</div>
